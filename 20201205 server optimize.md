# 2020年12月5日服务器优化分析：

## 小贝服务器性能部分（game， serverList, mapHall）：
    1:  mapHall:
        1.1: 将地图模板相关操作从 game 转移到 mapHall (减少交互次数同时方便横向扩展)
        1.2: mapHall横向扩展 和 地图模板服务器状态管理（动态更新）
        1.3: 单个mapHall吞吐量（TPS,QPS,RPS,RT）<MySQL 速度优化 和 累计数据量后的MySql性能下降问题>
        1.4: mapHall 动态扩容 及 房间<状态>同步
        1.5: 日志完善  和  错误报警
        1.6: 完整的测试方案
        
        
    2： serverList:
        2.1：服务器配置数据查询速度（MySQL查询速度）
        2.2：game服务器上报状态的TPS
        2.3：serverList 吞吐量和动态扩容 及 服务器状态管理（服务器开销等信息收集和统计）
        2.4：日志完善  和  错误报警
        2.5：完整的测试方案

    3：game:
        3.1：登录流程优化
             3.1.1： user data 在登录时处理 （解决socket upgrade 缺失问题）<客户端/服务器>
             3.1.2： 数据切分（非必要数据只在 需要使用时才请求）<客户端 / 服务器>
        3.2：地图模板等 动作的处理交给对应的 web服务器处理 <客户端/服务器>
        3.3：grid 代码整理 和 解耦 <服务器>
        3.4：从新规划 chunk 和 grid 管理关系 <服务器>     
        3.5：代码块交换和数据结构 重构 （减少存储所需空间）<客户端/服务器>
        3.6：当 chunk  线程宕机时的恢复方案。<服务器>
        3.7：代码块事件触发检索方案优化（3000个实体 * 100事件/实体  做对比时间维度）
        3.8：统一 玩家视野和摄像头功能<目前为两种模式>做成组件方便扩展，<策划、客户端、服务器>
        3.9：非修改的数据在服务器启动时不保存到数据库
        3.10：跟踪确认修改 某些时间点， GRID tick 耗时较久问题（实体tick耗时 / 事件处理耗时）确认具体的耗时动作并加以调整和从新设计方案

    4：小贝具体服务模型 （策划）

            
## 小贝稳定性：

    









----

##  1 性能
     1.1 吞吐量 
        1.1.1 TPS(每秒事务处理数)
        1.1.2 QPS(查询量/秒)
        1.1.3 RPS(请求数/秒)
        1.1.4 RT(响应时间/think time)
     1.2 并发数     
     1.3 CPU / 内存消耗
    

## 2 稳定性

## 3 可维护性
    1. 发现问题（测试案例，日志，上报系统）
    2. 定位问题（定位/跟踪问题）

## 4 可扩展性
    1. 功能细分模块化
    2. 功能模块/函数  解耦（单一化）

----



